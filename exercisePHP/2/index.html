
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="css/reset.css">
    <link rel="stylesheet" href="css/main.css">
    
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>

</head>
<body>

    <div class="content">
        <div class="sideContent">
            
            <button onclick="refreshMainContent()" class="mainButton">Go!</button>
                
        </div>

        <div class="mainContent" id="contentToRefresh">

            <!-- The initial value here will determine what color the server sends back -->
            <p id="theNumber">0</p>

        </div>
    </div>


    <script>

        // Posts the current number to the server. In PHP it will increment the value and send it back with a color.
        // On success it will refresh the right side of the page.
        // On failure it will alert the user and reset the number value to 0.
        function refreshMainContent()
        {
            const errorMsg = "Something went wrong."
            const errorMsg2 = "This error is left intentionally to demonstrate error handling.";
            let contentToRefesh = document.getElementById("contentToRefresh");
            let theNumber = document.getElementById("theNumber").innerHTML;
                $.ajax({
                url: "process.php",
                type: "post",
                dataType: "json",
                data: {num: theNumber},
                success: function(result){
                    console.log(result.success + " " + result.newNumber + " " + result.color);

                    if (result.success){
                        document.getElementById("theNumber").innerHTML = result.newNumber;
                        contentToRefesh.style.backgroundColor = result.color;
                    }
  
                }
                
            }).fail(function(){
                alert(errorMsg + " Resetting now.\n\n" + errorMsg2);
                        document.getElementById("theNumber").innerHTML = 0;
            })

        }    

    </script>

</body>
</html>